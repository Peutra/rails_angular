<div ng-controller="voteCtrl as voteController">
  <div class="spacer"></div>
  <div class="spacer"></div>
  <div class="container">
    <div class="col s8 offset-s2 center">
      <div class="row">
        <a ui-sref="createProduct" class="btn waves-effect waves-light amber darken-3">Ajouter un produit</a>
      </div>
    </div>
  </div>

  <div class="spacer"></div>

  <div class="container">
    <div class="col s8 offset-s2">
      <div class="row">
        <div ng-repeat="product in products">
          <div class="col s12 m6 l4">
            <div class="card">
              <div ng-if="product.id == hasVotted" id="has-voted" class="center"><p>A vot√©</p></div>
              <a href="#">
                <div class="card-image">
                  <!-- Modal Trigger -->
                  <a class="average-rating" data-target='rating-modal-{{product.id}}' modal><span class="new badge blue"> Note : 0 </span></a>
                  <!-- End of Modal Trigger -->
                  <img ng-click="vote(product.id)" src="{{product.picture_url}}" style="background: linear-gradient(-225deg, rgba(0,101,168,0.6) 0%, rgba(0,36,61,0.6) 50%);">
                  <span class="card-title">{{product.first_name}} {{product.last_name}}</span>
                </div>
              </a>
              <div class="card-content">
                <p>{{product.description | limitTo:100 }} ...</p>
              </div>
              <div class="card-action">
                <a href="#">En savoir plus</a>
                <span class="new badge blue"><b>{{product.value | number}}</b>  <i class="fa fa-credit-card-alt" aria-hidden="true"></i></span>
              </div>
            </div>
          </div>
          <!-- Modal Structure -->
          <div id="rating-modal-{{product.id}}" class="modal" ng-controller="rateProductCtrl as rateProductController">
              <div class="modal-content">
                <h4>{{product.first_name}} {{product.last_name}}</h4>
                <div class="stars">
                  <form class="rating" action="">
                    <input class="star star-5" ng-click="rateProduct(product.id, 5)" id="star-5-{{product.id}}" type="radio" name="star"/>
                    <label class="star star-5" for="star-5-{{product.id}}"></label>
                    <input class="star star-4" ng-click="rateProduct(product.id, 4)" id="star-4-{{product.id}}" type="radio" name="star"/>
                    <label class="star star-4" for="star-4-{{product.id}}"></label>
                    <input class="star star-3" ng-click="rateProduct(product.id, 3)" id="star-3-{{product.id}}" type="radio" name="star"/>
                    <label class="star star-3" for="star-3-{{product.id}}"></label>
                    <input class="star star-2" ng-click="rateProduct(product.id, 2)" id="star-2-{{product.id}}" type="radio" name="star"/>
                    <label class="star star-2" for="star-2-{{product.id}}"></label>
                    <input class="star star-1" ng-click="rateProduct(product.id, 1)" id="star-1-{{product.id}}" type="radio" name="star"/>
                    <label class="star star-1" for="star-1-{{product.id}}"></label>
                  </form>
                </div>
              </div>
          </div>
          <!-- End of modal structure -->
        </div>
      </div>
    </div>
  </div>
  <div class="spacer"></div>
  <div class="spacer"></div>
</div>
